<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Login Form</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function submitLoginForm() {
            const userId = $("#loginId").val();
            const userPwd = $("#loginPwd").val();

            $.ajax({
                type: "POST",
                url: "/users/login",
                data: JSON.stringify({ userId: userId, userPwd: userPwd }),
                contentType: "application/json",
                success: function(response) {
                    if (response.isExpert) {
                        alert("Expert login successful");
                        window.location.href = "/mypage";

                    } else {
                        alert("User login successful");
                        // window.location.href = "/pages/home"; // 로그인 성공 시 홈 페이지로 리디렉션
                        window.location.href = "/matching";
                    }
                },
                error: function(error) {
                    alert("Invalid credentials");
                }
            });
        }

        function logout() {
            $.ajax({
                type: "GET",
                url: "/users/logout",
                success: function(response) {
                    alert(response);
                    window.location.href = "/pages/loginform"; // 로그아웃 시 로그인 페이지로 리디렉션
                },
                error: function(error) {
                    alert("Logout failed");
                }
            });
        }
    </script>
</head>
<body>
<h1>Login Form</h1>
<h2><a href="http://localhost:8080">Go back</a></h2>
<form onsubmit="event.preventDefault(); submitLoginForm();">
    <div>
        <label for="loginId">User ID:</label>
        <input type="text" id="loginId" required />
    </div>
    <div>
        <label for="loginPwd">Password:</label>
        <input type="password" id="loginPwd" required />
    </div>
    <div>
        <button type="submit">Login</button>
    </div>
</form>
<div id="response"></div>

<button onclick="logout()">Logout</button>
</body>
</html>