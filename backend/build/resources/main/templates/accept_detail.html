<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>진행중인 검수 세부사항</title>
</head>
<body>
  <h2>진행중인 검수 작업</h2>
  <div>
    <p>모델: <span th:text="${inspection.model}"></span></p>
    <p>검수 장소: <span th:text="${inspection.place}"></span></p>
    <p>검수 날짜: <span th:text="${inspection.inspectDate}"></span></p>

    <input type="hidden" id="engineerId" th:value="${inspection.engineerId}"/>
    <input type="hidden" id="matchingId" th:value="${inspection.matchingId}"/>
  </div>
<button onclick = "completeInspection()">검수 완료</button>

  <script>
      function handleResponse(response) {
          var engineerId = document.getElementById('engineerId').value

          if (response.status === 'complete') {
              alert('수락했습니다.');
              window.location.href = '/matching/accept/list/' + engineerId;
          } else {
              alert('실패했습니다.');
          }
      }

      function sendRequest(url, method, data) {
          fetch(url, {
              method: method,
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify(data)
          })
              .then(response => response.json())
              .then(data => handleResponse(data))
              .catch(error => console.error('Error:', error));
      }

      function completeInspection(){
          sendRequest('/matching/request/complete/' + document.getElementById('matchingId').value, 'POST', {checked : true});
      }
  </script>
</body>
</html>